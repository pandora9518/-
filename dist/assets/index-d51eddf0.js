import{I as k,d as K,k as p,D as Q,A as W,r as s,o as U,c as T,h as e,w as l,y as C,u as r,g as X,x as h,a as Y,L as _,_ as Z}from"./index-511768d2.js";const w=(i,d)=>k.get(`/admin/product/baseTrademark/${i}/${d}`),ee=i=>i.id?k.put("/admin/product/baseTrademark/update",i):k.post("/admin/product/baseTrademark/save",i),ae=i=>k.delete(`/admin/product/baseTrademark/remove/${i}`),te=["src"],le=["src"],oe=K({__name:"index",setup(i){let d=p(1),m=p(3),f=p([]),b=p(10),x=p(),n=Q({tmName:"",logoUrl:""}),u=p(!1),v=async(a=1)=>{d.value=a;let t=await w(d.value,m.value);f.value=t.data.records,b.value=t.data.total};W(async()=>{let a=await w(d.value,m.value);f.value=a.data.records,b.value=a.data.total});let V=async()=>{(await ee(n)).code==200?(_({type:"success",message:n.id?"修改成功":"添加成功"}),v()):_({type:"error",message:n.id?"修改失败":"添加失败"})},z=()=>{u.value=!0,n.logoUrl="",n.tmName="",n.id=0},q=a=>{u.value=!0,Object.assign(n,a)};const D=()=>{u.value=!1},L=async()=>{await x.value.validate(),u.value=!1,V()},E=(a,t)=>{x.value.clearValidate("logoUrl"),n.logoUrl=a.data},O=a=>{if((a.type=="image/jpeg"||"image/png")&&a.size/1024/1024<4)return _({type:"success",message:"上传成功"}),!0;_({type:"error",message:"上传失败"})},P={tmName:[{require:!0,trigger:"blur",validator:(a,t,c)=>{t.trim().length>=2?c():c(new Error("品牌名称必须大于2"))}}],logoUrl:[{require:!0,validator:(a,t,c)=>{t!=""?c():c(new Error("品牌Logo获取失败"))}}]},$=async a=>{await ae(a)==200?(v(f.value.length>1?d.value:d.value-1),_({type:"success",message:"删除成功"})):_({type:"error",message:"删除失败"})};return(a,t)=>{const c=s("el-input"),N=s("el-form-item"),B=s("Plus"),M=s("el-icon"),S=s("el-upload"),j=s("el-form"),g=s("el-button"),A=s("el-dialog"),y=s("el-table-column"),R=s("el-popconfirm"),G=s("el-table"),I=s("el-card"),F=s("el-pagination");return U(),T("div",null,[e(A,{modelValue:r(u),"onUpdate:modelValue":t[1]||(t[1]=o=>h(u)?u.value=o:u=o),title:r(n).id?"修改品牌":"添加品牌"},{footer:l(()=>[e(g,{type:"info",onClick:D},{default:l(()=>[C("取消")]),_:1}),e(g,{type:"primary",onClick:L},{default:l(()=>[C("确定")]),_:1})]),default:l(()=>[e(j,{style:{width:"80%"},model:r(n),rules:P,ref_key:"formRef",ref:x},{default:l(()=>[e(N,{label:"品牌名称",prop:"tmName"},{default:l(()=>[e(c,{placeholder:"请输入品牌名称",modelValue:r(n).tmName,"onUpdate:modelValue":t[0]||(t[0]=o=>r(n).tmName=o)},null,8,["modelValue"])]),_:1}),e(N,{label:"品牌LOGO",prop:"logoUrl"},{default:l(()=>[e(S,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","on-success":E,"before-upload":O,"show-file-list":!1},{default:l(()=>[r(n).logoUrl?(U(),T("img",{key:0,src:r(n).logoUrl,class:"avatar"},null,8,te)):(U(),X(M,{key:1,class:"avatar-uploader-icon"},{default:l(()=>[e(B)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(I,{class:"box-card"},{header:l(()=>[e(g,{type:"primary",icon:"Plus",onClick:r(z)},{default:l(()=>[C("添加内容")]),_:1},8,["onClick"])]),default:l(()=>[e(G,{border:"",data:r(f)},{default:l(()=>[e(y,{label:"序号",align:"center",width:"120",type:"index"}),e(y,{label:"品牌名称",prop:"tmName"}),e(y,{label:"品牌LOGO"},{default:l(({row:o,$index:H})=>[Y("img",{src:o.logoUrl,alt:"图片不存在",style:{width:"100px",height:"100px",display:"block"}},null,8,le)]),_:1}),e(y,{label:"品牌操作"},{default:l(({row:o,$index:H})=>[e(g,{type:"primary",icon:"Edit",onClick:J=>r(q)(o)},null,8,["onClick"]),e(R,{title:"你确定要删除商品吗?",width:"220",icon:"Delete",onConfirm:J=>$(o.id)},{reference:l(()=>[e(g,{type:"primary",size:"default",icon:"Delete"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1}),e(F,{"current-page":r(d),"onUpdate:currentPage":t[2]||(t[2]=o=>h(d)?d.value=o:d=o),"page-size":r(m),"onUpdate:pageSize":t[3]||(t[3]=o=>h(m)?m.value=o:m=o),"page-sizes":[3,5,7,9],small:!1,background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:r(b),style:{"margin-left":"20px"},onCurrentChange:r(v),onSizeChange:r(v)},null,8,["current-page","page-size","total","onCurrentChange","onSizeChange"])])}}});const de=Z(oe,[["__scopeId","data-v-e9575ca1"]]);export{de as default};
