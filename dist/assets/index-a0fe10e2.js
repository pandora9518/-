import{I as f,d as $,k as V,D as A,A as O,r as o,o as j,c as B,h as e,w as t,y as u,t as D,u as r,x as E,F,L as p}from"./index-511768d2.js";const N=()=>f.get("/admin/acl/permission"),R=d=>d.id?f.put("/admin/acl/permission/update",d):f.post("/admin/acl/permission/save",d),T=d=>f.delete("/admin/acl/permission/remove/"+d),I=$({__name:"index",setup(d){let b=V([]),n=V(!1),a=A({code:"",level:0,name:"",pid:0});O(()=>{_()});const _=async()=>{let s=await N();s.code==200&&(b.value=s.data)},C=s=>{n.value=!0,Object.assign(a,{id:0,code:"",level:0,name:"",pid:0}),a.level=s.level+1,a.pid=s.id},k=s=>{n.value=!0,Object.assign(a,s)},x=async()=>{(await R(a)).code==200?(p({type:"success",message:a.id?"修改成功":"添加成功"}),n.value=!1,_()):p({type:"error",message:a.id?"修改失败":"添加失败"})},P=async s=>{(await T(s.id)).code==200?(p({type:"success",message:"删除成功"}),_()):p({type:"error",message:"删除失败"})};return(s,i)=>{const c=o("el-table-column"),m=o("el-button"),z=o("el-popconfirm"),q=o("el-table"),v=o("el-input"),y=o("el-form-item"),M=o("el-form"),U=o("el-dialog");return j(),B(F,null,[e(q,{data:r(b),"row-key":"id",border:""},{default:t(()=>[e(c,{label:"名称",prop:"name"}),e(c,{label:"权限值",prop:"code"}),e(c,{label:"更新时间",prop:"updateTime"}),e(c,{label:"操作"},{default:t(({row:l,$index:G})=>[e(m,{type:"primary",size:"small",onClick:g=>C(l),disabled:l.level==4},{default:t(()=>[u(D(l.level==3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick","disabled"]),e(m,{type:"primary",size:"small",disabled:l.level==1,onClick:g=>k(l)},{default:t(()=>[u("编辑")]),_:2},1032,["disabled","onClick"]),e(z,{title:`你确定要删除${l.name}吗?`,onConfirm:g=>P(l),width:"250"},{reference:t(()=>[e(m,{type:"primary",size:"small",disabled:l.level==1},{default:t(()=>[u("删除")]),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),e(U,{modelValue:r(n),"onUpdate:modelValue":i[2]||(i[2]=l=>E(n)?n.value=l:n=l),title:"添加用户"},{default:t(()=>[e(M,null,{default:t(()=>[e(y,{label:"名称"},{default:t(()=>[e(v,{placeholder:"请你输入菜单名称",modelValue:r(a).name,"onUpdate:modelValue":i[0]||(i[0]=l=>r(a).name=l)},null,8,["modelValue"])]),_:1}),e(y,{label:"权限"},{default:t(()=>[e(v,{placeholder:"请你输入权限数值",modelValue:r(a).code,"onUpdate:modelValue":i[1]||(i[1]=l=>r(a).code=l)},null,8,["modelValue"])]),_:1})]),_:1})]),footer:t(()=>[e(m,{size:"default"},{default:t(()=>[u("取消")]),_:1}),e(m,{type:"primary",size:"default",onClick:x},{default:t(()=>[u("确定")]),_:1})]),_:1},8,["modelValue"])],64)}}});export{I as default};
